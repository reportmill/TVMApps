/*
 * This file was generated by the Gradle 'init' task.
 */

buildscript {
    repositories {
        mavenCentral()
        maven { url "https://jitpack.io" }
    }

    dependencies {
        classpath 'com.github.vic-cw:teavm-gradle-plugin:b78fd1b'
    }
}

plugins {
    id 'java'
    id 'maven-publish'
}

apply plugin: 'com.edibleday.teavm'

repositories {
    mavenLocal()
    maven {
        url = 'http://repo.maven.apache.org/maven2'
    }
}

dependencies {
    compileOnly 'org.teavm:teavm-classlib:0.6.1'
    compileOnly 'org.teavm:teavm-jso-apis:0.6.1'
    compileOnly 'javax.servlet:javax.servlet-api:3.1.0'
    compile project(':SnapKit')
    compile project(':SnapTea')
    compile project(':SnapDemos')
}

group = 'tvmapps'
version = '1.0-SNAPSHOT'

sourceCompatibility = '1.8'
buildDir = 'build'

publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

teavmc {

    // Class with `public static void main(String[] args)` method:
    mainClass = "tvmapps.TVBusyBox"

    /* Where to put final web app */
    installDirectory "${project.buildDir}/teavm"

    /* Main JavaScript file name */
    targetFileName 'classes.js'

    /* Copy sources to install directory for simpler debugging */
    copySources false

    /* Generate JavaScript to Java mapping for debugging */
    generateSourceMap false

    /* Minify JavaScript */
    minified true

    /* Runtime inclusion: NONE, MERGED, SEPARATE */
    runtime org.teavm.tooling.RuntimeCopyOperation.MERGED
}

/**
SNAP_ROOT="/Users/jeff/SnapDev"
TV_JPATH=$SNAP_ROOT"/SnapTea/lib/teavm-cli.jar"
SK_CPATH=$SNAP_ROOT"/SnapKit/out/production/classes/"
ST_CPATH=$SNAP_ROOT"/SnapTEA/out/production/classes/"
SD_CPATH=$SNAP_ROOT"/SnapDemos/out/production/classes/"
JB_JPATH="/Users/jeff/SnapCode/SnapStudio/lib/jbox2d-2.2.jar"
MY_CPATH=$SNAP_ROOT"/TVMApps/out/production/classes/"
TV_CPATH=$TV_JPATH:$SK_CPATH:$ST_CPATH:$SD_CPATH:$MY_CPATH:$JB_JPATH
TV_MAIN="org.teavm.cli.TeaVMRunner"
MY_MAIN="tvmapps.TVFacetris"
MY_OUT=$SNAP_ROOT"/TVMApps/build/teavm"
TV_OPTS=$TV_MAIN" "$MY_MAIN" -d "$MY_OUT

java -cp $TV_CPATH $TV_OPTS -G -g
java -cp $TV_CPATH $TV_OPTS -m
cd TVOUT; http-server -c10
open http://localhost:8080/index.html
*/